<div class="sessions-container">
  <div class="page-header">
    <div>
      <h1>üéØ Sess√µes</h1>
      <p>Gerenciamento de sess√µes de opera√ß√£o</p>
    </div>
    <button class="btn-primary" (click)="showOpenModal = true" *ngIf="!activeSession">
      + Abrir Nova Sess√£o
    </button>
    <button class="btn-danger" (click)="showCloseModal = true" *ngIf="activeSession">
      Fechar Sess√£o Ativa
    </button>
  </div>

  <!-- Sess√£o Ativa -->
  <div class="active-session-card" *ngIf="activeSession">
    <h2>üü¢ Sess√£o Ativa</h2>
    <h3>{{ activeSession.name }}</h3>
    <div class="session-info">
      <div class="info-item">
        <span class="label">Iniciada em:</span>
        <span class="value">{{ formatDate(activeSession.startedAt) }}</span>
      </div>
      <div class="info-item">
        <span class="label">Caixa inicial:</span>
        <span class="value">{{ formatCurrency(activeSession.initialCash) }}</span>
      </div>
      <div class="info-item">
        <span class="label">Aberta por:</span>
        <span class="value">{{ activeSession.openedBy }}</span>
      </div>
    </div>
  </div>

  <!-- Hist√≥rico de Sess√µes -->
  <div class="sessions-list">
    <h2>üìã Hist√≥rico de Sess√µes</h2>
    <div class="session-card" *ngFor="let session of sessions">
      <div class="session-header">
        <h3>{{ session.name }}</h3>
        <span class="status-badge" [class.active]="session.isActive" [class.closed]="!session.isActive">
          {{ session.isActive ? 'üü¢ Ativa' : 'üî¥ Fechada' }}
        </span>
      </div>
      <div class="session-details">
        <div class="detail-row">
          <span>Iniciada:</span>
          <span>{{ formatDate(session.startedAt) }}</span>
        </div>
        <div class="detail-row" *ngIf="session.closedAt">
          <span>Fechada:</span>
          <span>{{ formatDate(session.closedAt) }}</span>
        </div>
        <div class="detail-row">
          <span>Caixa inicial:</span>
          <span>{{ formatCurrency(session.initialCash) }}</span>
        </div>
        <div class="detail-row" *ngIf="session.finalCash">
          <span>Caixa final:</span>
          <span>{{ formatCurrency(session.finalCash) }}</span>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal Abrir Sess√£o -->
<div class="modal-overlay" *ngIf="showOpenModal" (click)="showOpenModal = false">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Abrir Nova Sess√£o</h2>
      <button class="close-btn" (click)="showOpenModal = false">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="form-group">
        <label>Nome da Sess√£o *</label>
        <input type="text" [(ngModel)]="openForm.name" placeholder="Ex: Sess√£o Sexta-feira" />
      </div>
      <div class="form-group">
        <label>Caixa Inicial *</label>
        <input type="number" [(ngModel)]="openForm.initialCash" step="0.01" min="0" />
      </div>
      <div class="form-group">
        <label>Observa√ß√µes</label>
        <textarea [(ngModel)]="openForm.observations" rows="3"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="showOpenModal = false">Cancelar</button>
      <button class="btn-primary" (click)="openSession()">Abrir Sess√£o</button>
    </div>
  </div>
</div>

<!-- Modal Fechar Sess√£o -->
<div class="modal-overlay" *ngIf="showCloseModal" (click)="showCloseModal = false">
  <div class="modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Fechar Sess√£o Ativa</h2>
      <button class="close-btn" (click)="showCloseModal = false">‚úï</button>
    </div>
    <div class="modal-body">
      <div class="info-box">
        <p><strong>Sess√£o:</strong> {{ activeSession?.name }}</p>
        <p><strong>Caixa inicial:</strong> {{ formatCurrency(activeSession?.initialCash || 0) }}</p>
      </div>
      <div class="form-group">
        <label>Caixa Final *</label>
        <input type="number" [(ngModel)]="closeForm.finalCash" step="0.01" min="0" />
      </div>
      <div class="form-group">
        <label>Observa√ß√µes</label>
        <textarea [(ngModel)]="closeForm.observations" rows="3"></textarea>
      </div>
    </div>
    <div class="modal-footer">
      <button class="btn-secondary" (click)="showCloseModal = false">Cancelar</button>
      <button class="btn-danger" (click)="closeSession()">Fechar Sess√£o</button>
    </div>
  </div>
</div>
